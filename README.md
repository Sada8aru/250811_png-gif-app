# プロジェクト概要

手前の透過レイヤー（GIF or 連番PNG、連番JPG）と背景レイヤー(JPG or PNG)を合成し、静止画PNGかアニメーションGIFとして書き出す、シングルページのWebアプリケーションです。

## 仕様

透過レイヤー（GIF or 連番PNG、連番JPG）と背景レイヤー(JPG or PNG)を合成し、静止画PNGかアニメーションGIFとして書き出すシングルページのWebアプリで、以下の機能を持ちます。

### インプットUI

背景画像の追加変更と、透過レイヤーの追加変更が可能なインプットUIを持つ。

1. 読み込んだ素材の情報をそれぞれ表示する

- 背景画像のpxサイズ
- 透過レイヤー総フレーム数を表示

2. 2回目以降、ファイルを選択ボタン or ドラッグ＆ドロップ

- 新しい素材を取り込む（透過レイヤーの場合）
    - 位置：デフォルト中央配置。2回目以降直前の設定を引き継ぐ
    - スケール：デフォルト値1倍。2回目以降、後述の条件に従う
    - 再生速度：
        - 「連番PNG」：デフォルト値500ms。2回目以降、後述の条件に従う
        - 「GIF」：元の再生速度に応じる
        - 「静止画」：設定なし
- 2回目以降の条件：
    - 直前が「連番PNG」→入れ替え後も「連番PNG」：倍率と位置、再生速度を保持
    - 直前が「連番PNG」→入れ替え後「GIF」：位置のみ保持
    - 直前が「GIF」→入れ替え後「連番PNG」: 位置のみ保持
    - 直前が「GIF」→入れ替え後「GIF」: 位置のみ保持

### プレビュー画面

合成のプレビュー画面。以下の機能を持つ。

1. 透過レイヤーを再生する（GIFか連番の場合）

- 読み込み元がGIFの場合、元のスピードを基準とする。
- 連番画像の場合、500msを基準とする

2. 透過レイヤーをタップできる

- バウンディングボックスが表示される
- 自由に移動させられる
- アスペクト比を保ちながら、拡大縮小できる

### 調整GUI

細かく数値で調整できる機能を持つ。調整結果はプレビュー画面と連動する。

1. 「操作モード」タブ

- プレビュー画面の操作モードをタブで切り替えられる。2-A「画像」か2-B「トリミング」のどちらかを表示する。
- 「編集」: 透過レイヤーの操作ができるモード
    - 「画像」UIを表示する
- 「トリミング」: 全体のトリミング機能を持つモード
    - 「アスペクト比」UIを表示する

2-A. 「画像」

- サイズ：
    - 透過レイヤーのサイズを変更できる。
    - 整数倍で、1倍以下にはならない
    - 拡大の基点は中心座標とする

- 整列：
    - 中央、上下、左右、四隅の9箇所のボタンを持ち、配置できる
    - 配置はトリミング枠内の移動とする

-  X座標、Y座標：
    - 上下左右に微調整できるよう数値入力UIを持つ
    - 整数px値の移動とする

2-B. 「アスペクト比」

- 比率を選択可能
   - 元の比率、自由形式、1:1、16:9（横縦）、4:3（横縦）

3. 「アニメーション設定」

- 透過レイヤーがGIFか連番の場合の場合、再生速度を調整できる（スライダー）


4. 「エクスポート」

- PNGかGIFの書き出しが選択できる。
- 透過レイヤーが画像1枚であれば、静止画PNG書き出しのみ対応
- 透過レイヤーが連番PNGかGIFであれば、GIF書き出し or 静止画PNG書き出しの選択が可能

## 使い方

1. 依存インストール

```bash
npm install
```

2. 開発サーバー起動

```bash
npm run dev
```

3. ビルド

```bash
npm run build
```

4. ビルド結果の確認

```bash
npm run preview
```
